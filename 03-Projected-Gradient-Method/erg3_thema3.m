% Ορισμός της συνάρτησης και των παραμέτρων
f = @(x1, x2) (1/3)*(x1^2) + 3*(x2^2); % Συνάρτηση που ελαχιστοποιούμε
grad_f = @(x1, x2) [2/3*x1; 6*x2]; % Gradient της f
projection = @(x) [min(max(x(1), -10), 5); min(max(x(2), -8), 12)]; % Προβολή στους περιορισμούς

% Παράμετροι
x0 = [-5; 10]; % Αρχικό σημείο (x1, x2)
epsilon = 0.01; % Ακρίβεια
s_k = 15; % Παράγοντας μεγέθους βήματος
gamma_k = 0.1; % Βήμα προσαρμογής
max_iter = 100000; % Μέγιστος αριθμός επαναλήψεων

% Αρχικοποίηση
x_k = x0; % Τρέχουσα θέση
k = 0; % Μετρητής επαναλήψεων
f_values = []; % Αποθήκευση τιμών της συνάρτησης
trajectory = x_k'; % Αποθήκευση τροχιάς για γραφική αναπαράσταση

% Μέθοδος Μέγιστης Καθόδου με Προβολή
while norm(grad_f(x_k(1), x_k(2))) > epsilon && k < max_iter
    % Υπολογισμός του gradient
    gradient = grad_f(x_k(1), x_k(2)); % Gradient στο x_k
    
    % Υπολογισμός της νέας θέσης χωρίς περιορισμούς
    x_new = x_k - s_k * gradient;
    
    % Εφαρμογή προβολής για να διασφαλιστούν οι περιορισμοί
    x_proj = projection(x_new);
    
    % Ενημέρωση θέσης με τον παράγοντα προσαρμογής gamma_k
    x_k = x_k + gamma_k * (x_proj - x_k);
    
    % Ενημέρωση μετρητή και αποθήκευση
    k = k + 1; % Ενημέρωση επαναλήψεων
    f_values = [f_values; f(x_k(1), x_k(2))]; % Αποθήκευση της τιμής f(x_k)
    trajectory = [trajectory; x_k']; % Αποθήκευση της τροχιάς
end

% Εμφάνιση αποτελεσμάτων
disp('Αποτελέσματα Μεθόδου Μέγιστης Καθόδου με Προβολή:');
disp(['Τελικό σημείο: (', num2str(x_k(1)), ', ', num2str(x_k(2)), ')']);
disp(['Αριθμός επαναλήψεων: ', num2str(k)]);

% Γραφική απεικόνιση της σύγκλισης της συνάρτησης
figure;
plot(1:length(f_values), f_values, 'b-', 'LineWidth', 2); % Σύγκλιση της f
xlabel('Αριθμός Επαναλήψεων');
ylabel('Τιμή της Συνάρτησης f(x, y)');
title('Σύγκλιση της Συνάρτησης με Μέθοδο Μέγιστης Καθόδου με Προβολή');
grid on;

% Γραφική απεικόνιση της τροχιάς στο επίπεδο (x1, x2)
figure;
plot(trajectory(:, 1), trajectory(:, 2), 'ro-', 'LineWidth', 2); % Τροχιά στο επίπεδο
hold on;
plot(x_k(1), x_k(2), 'go', 'MarkerSize', 10, 'MarkerFaceColor', 'g'); % Τελικό σημείο
xlabel('x_1');
ylabel('x_2');
title('Πορεία Σύγκλισης στο Επίπεδο (x1, x2)');
xlim([-10 5]);
ylim([-8 12]);
grid on;
legend('Πορεία Σύγκλισης', 'Τελικό Σημείο');
hold off;
