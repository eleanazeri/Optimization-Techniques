% Παράμετροι
gamma_values = [0.1, 0.3, 3, 5]; % Διαφορετικά βήματα (για να δούμε τη σύγκλιση με διαφορετικά βήματα)
tol = 0.001; % Όριο σύγκλισης
max_iter = 100000; % Μέγιστος αριθμός επαναλήψεων

% Αρχικό σημείο
start_point = [8, -10];  % Μόνο το (8, -10)

% Δημιουργία του διαγράμματος για τη σύγκλιση
figure;
hold on;
% Χρώματα για κάθε αρχικό σημείο
colors = ['b', 'g', 'r', 'c'];
% Εξαρτάται από το πόσα διαφορετικά σημεία έχουμε
line_handles = zeros(1, length(gamma_values)); % Χειριστές γραμμών για το legend

for i = 1:length(gamma_values)
    gamma = gamma_values(i);
    
    % Αρχικές συντεταγμένες
    x1 = start_point(1);
    x2 = start_point(2);
    
    f_values = []; % Για να αποθηκεύσουμε τις τιμές της συνάρτησης κατά την πορεία
    x1_values = []; % Για να αποθηκεύσουμε τις συντεταγμένες x1
    x2_values = []; % Για να αποθηκεύσουμε τις συντεταγμένες x2
    
    for iter = 1:max_iter
        % Υπολογισμός του gradient
        df_dx1 = (2/3) * x1;   % Παράγωγος ως προς x1
        df_dx2 = 6 * x2;        % Παράγωγος ως προς x2
        grad_f = [df_dx1; df_dx2];
        
        % Υπολογισμός τιμής της συνάρτησης f(x1, x2)
        f_val = (1/3) * x1^2 + 3 * x2^2;
        f_values = [f_values; f_val]; % Αποθήκευση τιμής
        
        % Αποθήκευση των συντεταγμένων x1 και x2
        x1_values = [x1_values; x1];
        x2_values = [x2_values; x2];
        
        % Ενημέρωση θέσης
        x1_new = x1 - gamma * grad_f(1);
        x2_new = x2 - gamma * grad_f(2);
        
        % Έλεγχος σύγκλισης
        if norm([x1_new - x1, x2_new - x2]) < tol
            break;
        end
        
        % Ενημέρωση των τιμών για το επόμενο βήμα
        x1 = x1_new;
        x2 = x2_new;
    end
    
    % Εκτύπωση αποτελεσμάτων για κάθε γάμμα
    fprintf('Μέγιστη Κάθοδος: Αρχικό σημείο: (%f, %f), Σύγκλιση σε (%f, %f) με γάμμα %f σε %d επαναλήψεις.\n', ...
        start_point(1), start_point(2), x1, x2, gamma, iter);
    
    % Σχεδίαση της σύγκλισης της συνάρτησης f(x1, x2) με συγκεκριμένο χρώμα
    line_handles(i) = plot(1:length(f_values), f_values, colors(i), 'LineWidth', 2);
    
    % Προσθήκη του ελαχίστου σημείου και της αντίστοιχης τιμής της συνάρτησης
    plot(iter, f_values(end), 'ro', 'MarkerFaceColor', 'r'); % Ενδεικτικό σημείο ελαχίστου
    text(iter, f_values(end), sprintf('  (%.2f, %.2f)', x1, x2), 'FontSize', 8);
end

% Ρυθμίσεις του διαγράμματος
xlabel('Αριθμός Επαναλήψεων');
ylabel('Τιμή της Συνάρτησης f(x1, x2)');
title('Σύγκλιση της Συνάρτησης με Μέθοδο Μέγιστης Καθόδου και Σταθερό Βήμα');
% Δημιουργία του legend με βάση τους χειριστές γραμμών και τα χρώματα
legend(line_handles, {'γ = 0.1', 'γ = 0.3', 'γ = 3', 'γ = 5'});
hold off;
